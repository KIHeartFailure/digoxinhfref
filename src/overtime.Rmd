```{r overtime, fig.cap="Digoxin use overtime"}

overtime <- overtime %>%
  filter(AR >= 2006, AR <= 2018) %>%
  mutate(percent = n / nrow(pdata) * 100) %>%
  as.data.frame()

ggplot(
  data = overtime,
  aes(x = AR, y = percent)) +
  geom_line(color = global_kicols[1], size = 2) +
  geom_point(size = 2) +
  theme_minimal() +
  scale_x_continuous(labels = overtime$AR, breaks = overtime$AR, minor_breaks = overtime$AR) +
  #scale_y_continuous(labels = seq(0, 16, 1), breaks = seq(0, 16, 1), minor_breaks = seq(0, 16, 1)) +
  xlab("Year") +
  ylab("% of patients") +
  ylim(0, 16)
```

```{r overtimeaf, fig.cap="Digoxin use overtime - Patients with AF"}

overtime_af <- overtime_af %>%
  filter(AR >= 2006, AR <= 2018) %>%
  mutate(percent = n / nrow(pdata_af) * 100) %>%
  as.data.frame()

ggplot(
  data = overtime_af,
  aes(x = AR, y = percent)
) +
  geom_line(color = global_kicols[1], size = 2) +
  geom_point(size = 2) +
  theme_minimal() +
  scale_x_continuous(labels = overtime$AR, breaks = overtime$AR, minor_breaks = overtime$AR) +
  # scale_y_continuous(labels = seq(0, 12, .5), breaks = seq(0, 12, .5), minor_breaks = seq(0, 12, .5)) +
  xlab("Year") +
  ylab("% of patients") +
  ylim(0, 16)
```

```{r overtimeniaf, fig.cap="Digoxin use overtime - Patients without AF"}

overtime_noaf <- overtime_noaf %>%
  filter(AR >= 2006, AR <= 2018) %>%
  mutate(percent = n / nrow(pdata_noaf) * 100) %>%
  as.data.frame()

ggplot(
  data = overtime_noaf,
  aes(x = AR, y = percent)
) +
  geom_line(color = global_kicols[1], size = 2) +
  geom_point(size = 2) +
  theme_minimal() +
  scale_x_continuous(labels = overtime$AR, breaks = overtime$AR, minor_breaks = overtime$AR) +
  # scale_y_continuous(labels = seq(0, 12, .5), breaks = seq(0, 12, .5), minor_breaks = seq(0, 12, .5)) +
  xlab("Year") +
  ylab("% of patients") +
  ylim(0, 16)
```
